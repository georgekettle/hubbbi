<% editable ||= false %>

<div class="w-full relative">
  <div data-controller="lightbox">
    <%= link_to cl_image_path(pdf.file.key), data:{ action: "lightbox#open" }, class: "#{pdf.file.attached? ? 'dropdown-link' : 'dropdown-link-disabled'} shadow-sm p-2 w-full rounded-lg flex items-center justify-between border border-gray-200 hover:border-gray-300 bg-white inline-block" do %>
      <%= render 'pdfs/pdf_info', pdf: pdf %>
    <% end %>
    <%= render 'components/lightbox/container', title: pdf.title, subtitle: pdf.created_at.strftime("%A %B %d, %Y") do %>
      <!-- <iframe src="<%= cl_image_path(pdf.file.key) %>" width="100%" height="100%"></iframe> -->
      <div data-controller='pdf' data-pdf-url-value="<%= cl_image_path(pdf.file.key) %>" class="w-full h-full relative">
        <div class="absolute right-4 top-4 ">
          <div data-carousel-target="buttons" class="flex items-center rounded-md p-0.5 backdrop-filter backdrop-blur bg-black bg-opacity-50">
            <button data-action="click->pdf#prevPage" class="mr-1 w-6 h-6 rounded flex items-center justify-center hover:bg-white text-white hover:text-gray-800 cursor-pointer" type="button" aria-label="Previous">
              <%= render 'icons/chevron_right', classes: 'transform rotate-180 h-3 w-3 stroke-2 fill-current stroke-current' %>
            </button>
            <span class="text-white text-xs tracking-wider">
              <span data-pdf-target="pageNum"></span><span class="opacity-50"><%= render 'components/middle_dot' %></span><span data-pdf-target="pageCount"></span>
            </span>
            <button data-action="click->pdf#nextPage" class="ml-1 w-6 h-6 rounded flex items-center justify-center hover:bg-white text-white hover:text-gray-800 cursor-pointer" type="button" aria-label="Next">
              <%= render 'icons/chevron_right', classes: 'h-3 w-3 stroke-2 fill-current stroke-current' %>
            </button>
          </div>
        </div>
        <div class="w-full h-full">
          <canvas data-pdf-target="container" class="object-contain flex items-center justify-center h-full w-full">
            <%= render 'components/loaders/thinking' %>
          </canvas>
        </div>
      </div>
    <% end %>
  </div>

  <% if pdf.file.attached? %>
    <div class="absolute top-1/2 right-1 transform -translate-y-1/2 mr-2">
      <% if editable %>
        <%= render "components/dropdowns/options_dropdown", button_classes: "icon-btn", direction: "right" do %>
          <%= link_to "Update", edit_pdf_path(pdf), class: "dropdown-link" %>
          <%= link_to 'Delete', pdf, method: :delete, class: "dropdown-link-danger" %>
        <% end %>
      <% end %>
    </div>
  <% end %>
</div>
